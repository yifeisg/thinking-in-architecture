## Q1. 画出微信的业务架构图

![](https://github.com/yifeisg/thinking-in-architecture/blob/main/week01/wechat_business_architecture.jpg)

1. IM 内容转发包括转发群名片、用户名片、页面链接、小程序入口等功能;
2. 微信开放平台在我的理解里就是微信开发者平台，其实也包括了公众号开发和小程序开发，这部分和微信公众平台有重叠；
3. 红包既可以划到支付模块，也可以划到社交模块（并调用支付模块的某些功能），当我回头看这张图时，更倾向于将其划到社交模块下，或者独立出来；
4. 类似的，朋友圈其实也可以独立出来成为一个单独的模块（？）；
5. 用户管理模块中，钱包指余额和银行卡，卡包指各种会员卡和礼品卡等。

## Q2. 学生管理系统架构设计

### 问题描述

学生管理系统设计要求：

1. 可以通过公网域名访问；
2. 由至少 3 人合作完成；
3. 能够支撑管理 1000 个学生；
4. 不推荐太简单和太复杂的方案。

你找了 2 个好朋友一起来做这个项目，你们的基本情况如下：

1. 大家都会 Java，但是有一个是 PHP 高手；
2. 大家经济条件一般。

请对照面向复杂度架构设计方法论，构思 2 个以上的备选架构方案，说明每个方案的优缺点，并给出你选择的最终方案和理由。

### 整体思考

1. 学生系统的业务较为简单，且用户仅有 1000 人，整体复杂度低，因此不必过早使用过于复杂的架构设计，以**合适原则**为主；
2. 三人都会 Java 语言，虽然有一个是 PHP 高手，但以**简单原则**来考虑，技术选型应使用大家都熟悉的 Java；
3. 大家经济条件一般，因此不做直接购买独立服务器的考虑，推荐使用即租即用的云服务器；
4. 不推荐太简单的方案，且出于服务可用性的考虑，排除只用一台服务器的单体架构；
5. 不推荐太复杂的方案，且处于业务复杂度的考虑，排除微服务架构。

### 方案 A

![](https://github.com/yifeisg/thinking-in-architecture/blob/main/week01/design1.jpg)

#### 优点

1. 用 Nginx 网关实现了负载均衡；
2. 任意一台服务器宕机都不会影响系统提供服务；
3. 后续访问量增大时，可以非常轻松的水平扩容（加服务器）；
4. 系统复杂度低，开发难度简单。

#### 缺点

1. 所有的功能都堆积在一台服务器里，无法根据不同请求进行分流。

### 方案 B

![](https://github.com/yifeisg/thinking-in-architecture/blob/main/week01/design2.jpg)

#### 优点

1. 用 Nginx 网关实现了不同类型请求的转发；
2. 系统拆分为多个子模块后，任意模块发生故障时不会影响整个系统的运行；
3. 如果必要，各个子系统可以使用不同的开发语言；
4. 当有新的模块需要接入时，系统更容易扩展。

#### 缺点

1. 每个子模块都是一个单体子系统，可用性得不到保证；
2. 模块之间的交互变得更复杂，整个系统的复杂度升高。

### 最终选择

考虑到在学校这种场景下，更多时候会发生同类需求在同一个时间段的井喷（比如同时选课，同时查询考试成绩等），因此整个系统对于按不同请求进行分流的需求不难么强烈；且整体需求的复杂度较低，用户数也不多。

综合之下，更推荐使用 A 方案。
